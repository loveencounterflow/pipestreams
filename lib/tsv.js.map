{
  "version": 3,
  "file": "tsv.js",
  "sourceRoot": "..",
  "sources": [
    "src/tsv.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n\n\n'use strict'\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'PIPESTREAMS/TSV'\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\ninfo                      = CND.get_logger 'info',      badge\nurge                      = CND.get_logger 'urge',      badge\nhelp                      = CND.get_logger 'help',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\necho                      = CND.echo.bind CND\n\n#-----------------------------------------------------------------------------------------------------------\n@$name_fields = ( names ) ->\n  throw new Error \"µ43512 expected a list, got a #{type}\" unless ( type = CND.type_of names ) is 'list'\n  return @_map_errors ( fields ) =>\n    throw new Error \"µ43613 expected a list, got a #{type}\" unless ( type = CND.type_of fields ) is 'list'\n    R = {}\n    for value, idx in fields\n      name      = names[ idx ] ?= \"field_#{idx}\"\n      R[ name ] = value\n    return R\n\n#-----------------------------------------------------------------------------------------------------------\n@$split_on_tabs = ( settings ) ->\n  return @$ ( line, send ) =>\n    \"µ27918 expected a text, got a #{type}\" unless ( type = CND.type_of line ) is 'text'\n    send line.split /\\t/\n\n# #-----------------------------------------------------------------------------------------------------------\n# @$split_on_whitespace = ( field_count = null ) ->\n#   if ( field_count is 0 )\n#     throw new Error \"µ43714 field_count can not be zero\"\n#   #.........................................................................................................\n#   ### If user requested null or zero fields, we can just split the line: ###\n#   if ( not field_count? ) # or ( field_count is 0 )\n#     return @$ ( line, send ) => send line.split /\\s+/\n#   #.........................................................................................................\n#   ### If user requested one field, then the entire line is the field: ###\n#   if field_count is 1\n#     return @$ ( line, send ) => send [ line, ]\n#   #.........................................................................................................\n#   ### TAINT validate field_count is integer ###\n#   ### TAINT validate field_count is non-negative ###\n#   return @$ ( line, send ) =>\n#     \"µ28239 expected a text, got a #{type}\" unless ( type = CND.type_of line ) is 'text'\n#     fields  = []\n#     parts   = line.split /(\\s+)/\n#     pairs   = ( [ parts[ idx ], parts[ idx + 1 ] ? '' ] for idx in [ 0 ... parts.length ] by +2 )\n#     #.......................................................................................................\n#     ### Shift-push line contents from `pairs` into `fields` until exhausted or saturated: ###\n#     loop\n#       break if pairs.length <= 0\n#       break if fields.length >= field_count - 1\n#       fields.push pairs.shift()[ 0 ]\n#     #.......................................................................................................\n#     ### Concat remaining parts and add as one more field: ###\n#     if pairs.length > 0\n#       fields.push ( ( ( fld + spc ) for [ fld, spc, ] in pairs ).join '' ).trim()\n#     #.......................................................................................................\n#     ### Pad missing fields with `null`: ###\n#     ### TAINT allow to configure padding value ###\n#     fields.push null while fields.length < field_count\n#     #.......................................................................................................\n#     send fields\n\n#-----------------------------------------------------------------------------------------------------------\n@$split_on_whitespace = ( field_count = null ) ->\n  #.........................................................................................................\n  if ( field_count is 0 )\n    throw new Error \"µ43815 field_count can not be zero\"\n  #.........................................................................................................\n  ### If called with field_count `null`, we can just split the line: ###\n  if ( not field_count? )\n    return @$ ( line, send ) =>\n      R = ( ( if p is '' then null else p ) for p in line.split /\\s+/ )\n      R.pop() while R[ R.length - 1 ] is null\n      send R\n  #.........................................................................................................\n  ### If user requested one field, then the entire line is the field: ###\n  if field_count is 1\n    return @$ ( line, send ) => send [ line, ]\n  #.........................................................................................................\n  get_pattern = ( field_count ) =>\n    # return /^(*){1,}$/ if ( not field_count? ) or ( field_count is 0 )\n    R           = []\n    subpattern  = []\n    R.push '^'\n    subpattern.push '(\\\\S*)' for _ in [ 1 .. field_count - 1 ] by +1\n    R.push subpattern.join '\\\\s*'\n    R.push '\\\\s*(.*)'\n    R.push '$'\n    return new RegExp R.join ''\n  pattern = get_pattern field_count\n  #.........................................................................................................\n  return @$ ( line, send ) =>\n    \"µ27918 expected a text, got a #{type}\" unless ( type = CND.type_of line ) is 'text'\n    # debug 'µ78765-1', ( rpr pattern ), ( rpr line )\n    if ( '\\n' in line ) or not ( match = line.match pattern )?\n      throw new Error \"µ43916 illegal line: #{rpr line}\"\n    match = [ match..., ]\n    R     = []\n    # debug 'µ78765-2', ( rpr pattern ), ( rpr line ), ( rpr match )\n    for idx in [ 1 .. field_count ]\n      R.push if ( field = match[ idx ] ) is '' then null else field\n    send R\n\n#-----------------------------------------------------------------------------------------------------------\n@$trim_fields = -> @$watch ( fields  ) =>\n  throw new Error \"µ44017 expected a list, got a #{type}\" unless ( type = CND.type_of fields ) is 'list'\n  fields[ idx ] = field.trim() for field, idx in fields\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@$split_tsv = ->\n  R = []\n  R.push @$split()\n  # R.push @$trim()\n  R.push @$skip_blank()\n  ### TAINT use named method; allow to configure comment marker ###\n  R.push @$filter ( line ) -> not line.startsWith '#'\n  R.push @$split_on_tabs()\n  R.push @$trim_fields()\n  return @pull R...\n\n#-----------------------------------------------------------------------------------------------------------\n### TAINT use `settings` for extensibility ###\n@$split_wsv = ( field_count = null ) ->\n  R = []\n  R.push @$split()\n  # R.push @$sample 1 / 20000\n  # R.push @$trim()\n  R.push @$skip_blank()\n  ### TAINT use named method; allow to configure comment marker ###\n  R.push @$filter ( line ) -> not line.startsWith '#'\n  R.push @$split_on_whitespace field_count\n  return @pull R...\n\n\n"
  ]
}